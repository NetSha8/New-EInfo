---
export interface Props {
    slug: string;
    title: string;
    excerpt: string;
    date: string;
    readTime: string;
    category: string;
    tags: string[];
    className?: string;
}

import { Calendar, Clock, ArrowRight } from "lucide-astro";

const { slug, title, excerpt, date, readTime, category, tags, className = "" } = Astro.props;

function formatDate(dateStr: string): string {
  return new Date(dateStr).toLocaleDateString("fr-FR", {
    day: "numeric",
    month: "long",
    year: "numeric",
  });
}
---

<article class={`glass-card reveal overflow-hidden group relative flex flex-col h-full ${className}`}>
    <!-- Category Badge -->
    <div class="p-6 md:p-8 pb-0">
        <div class="flex items-center justify-between mb-4">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold bg-primary-600/15 text-primary-400 border border-primary-500/20">
                {category}
            </span>
            <div class="flex items-center gap-1.5 text-xs text-secondary">
                <Clock class="w-3.5 h-3.5" />
                <span>{readTime}</span>
            </div>
        </div>
    </div>

    <!-- Content -->
    <div class="px-6 md:px-8 flex-grow flex flex-col">
        <!-- Title -->
        <h3 class="text-lg md:text-xl font-bold text-main mb-3 group-hover:text-primary-400 transition-colors duration-300 line-clamp-2">
            {title}
        </h3>

        <!-- Excerpt -->
        <p class="text-secondary text-sm leading-relaxed mb-5 line-clamp-3">
            {excerpt}
        </p>

        <!-- Tags -->
        <div class="mb-6 flex-grow">
            <div class="flex flex-wrap gap-2">
                {
                    tags.slice(0, 3).map((tag) => (
                        <span class="tech-badge text-xs">
                            {tag}
                        </span>
                    ))
                }
                {tags.length > 3 && (
                    <span class="tech-badge text-xs">
                        +{tags.length - 3}
                    </span>
                )}
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="border-t border-dark-800 px-6 md:px-8 py-4 flex items-center justify-between">
        <div class="flex items-center gap-1.5 text-xs text-secondary">
            <Calendar class="w-3.5 h-3.5" />
            <time datetime={date}>{formatDate(date)}</time>
        </div>
        <span
            class="inline-flex items-center gap-1.5 text-primary-400 font-semibold text-sm transition-colors duration-300"
        >
            Lire l'article
            <ArrowRight class="w-4 h-4 transform group-hover:translate-x-1 group-focus-within:translate-x-1 transition-transform duration-300" />
        </span>
    </div>

    <a
        href={`/blog/${slug}`}
        aria-label={`Lire l'article : ${title}`}
        class="absolute inset-0 z-10 rounded-[inherit] focus:outline-none focus-visible:ring-2 focus-visible:ring-primary-500 focus-visible:ring-offset-2 focus-visible:ring-offset-dark-900"
    ></a>
</article>

<style>
    .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    .line-clamp-3 {
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
</style>
